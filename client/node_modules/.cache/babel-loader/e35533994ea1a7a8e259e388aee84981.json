{"ast":null,"code":"var _jsxFileName = \"/Users/gabrielpeter/PersonalWebsite1.0/client/src/components/spotify_comparer/personal_spotify_data.js\";\nimport './graph_styling.css';\nimport React, { Component } from 'react';\nimport * as $ from \"jquery\";\nimport ChartConstructor from './chart_constructor';\n\nclass Personal_Spotify_Data extends Component {\n  constructor(props) {\n    super(props); // https://developer.spotify.com/documentation/general/guides/authorization-guide/\n\n    this.state = {\n      access_token: '',\n      refresh_token: '',\n      spotify_data: {\n        top_artists: [{\n          'x': 0,\n          'y': 0\n        }],\n        genre_weights: [{\n          'x': 0,\n          'y': 'Undef'\n        }],\n        top_5_artists_graph: [{\n          'x': 'Undef',\n          'y': 0\n        }],\n        top_5_artists_images: [{\n          'name': '',\n          'images': [{\n            'url': ''\n          }]\n        }],\n        top_artists_popularity: [{\n          'x': 0,\n          'y': 0\n        }],\n        popularity_list: [{\n          'x': 0,\n          'y': 0\n        }],\n        average_artist_rank: 0,\n        genre_quantity: [{\n          'x': 0,\n          'y': 0\n        }],\n        genre_intersection: [{\n          'x': 0,\n          'y': 0\n        }],\n        radialRankings: [{\n          'angle': 360\n        }]\n      }\n    };\n  }\n\n  componentDidMount() {\n    fetch('/api/personal-token').then(res => res.json()).then(res => this.setState({\n      access_token: res.access_token,\n      refresh_token: res.refresh_token\n    }, () => this.refreshToken()));\n  }\n\n  refreshToken() {\n    $.ajax({\n      url: '/refresh_token',\n      data: {\n        'refresh_token': this.state.refresh_token\n      },\n      success: data => {\n        this.setState({\n          access_token: data.access_token\n        }, () => {\n          this.getTopArtists();\n        });\n      }\n    });\n  }\n\n  getTopArtists() {\n    $.ajax({\n      url: \"https://api.spotify.com/v1/me/top/artists?time_range=\".concat(this.props.timeFrame, \"&limit=50&offset=0\"),\n      type: \"GET\",\n      beforeSend: xhr => {\n        xhr.setRequestHeader(\"Authorization\", \"Bearer \" + this.state.access_token);\n      },\n      success: data => {\n        const spotify_data = this.props.analyseTermData(data);\n        this.setState({\n          spotify_data\n        });\n      },\n      error: (XMLHttpRequest, textStatus, errorThrown) => {\n        console.log(\"Status: \" + textStatus);\n        console.log(\"Error: \" + errorThrown);\n      }\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"spotify-components\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"I Like:\"), React.createElement(ChartConstructor, {\n      owner: \"me\",\n      average_artist_rank: this.state.spotify_data.average_artist_rank,\n      top_5_artists_images: this.state.spotify_data.top_5_artists_images,\n      data1: this.state.spotify_data.radialRankings,\n      data2: this.state.spotify_data.top_5_artists_graph,\n      genres: this.state.spotify_data.genre_weights,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Personal_Spotify_Data;","map":{"version":3,"sources":["/Users/gabrielpeter/PersonalWebsite1.0/client/src/components/spotify_comparer/personal_spotify_data.js"],"names":["React","Component","$","ChartConstructor","Personal_Spotify_Data","constructor","props","state","access_token","refresh_token","spotify_data","top_artists","genre_weights","top_5_artists_graph","top_5_artists_images","top_artists_popularity","popularity_list","average_artist_rank","genre_quantity","genre_intersection","radialRankings","componentDidMount","fetch","then","res","json","setState","refreshToken","ajax","url","data","success","getTopArtists","timeFrame","type","beforeSend","xhr","setRequestHeader","analyseTermData","error","XMLHttpRequest","textStatus","errorThrown","console","log","render"],"mappings":"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","sourcesContent":["import './graph_styling.css';\nimport React, { Component } from 'react';\nimport * as $ from \"jquery\";\nimport ChartConstructor from './chart_constructor';\nclass Personal_Spotify_Data extends Component {\n    constructor(props) {\n        super(props);\n        // https://developer.spotify.com/documentation/general/guides/authorization-guide/\n        this.state = {\n            access_token: '',\n            refresh_token: '',\n            spotify_data: {\n                top_artists: [{'x': 0, 'y': 0}],\n                genre_weights: [{'x': 0, 'y': 'Undef'}],\n                top_5_artists_graph: [{'x': 'Undef', 'y': 0,}],\n                top_5_artists_images: [{'name': '', 'images': [{'url': ''}]}],\n                top_artists_popularity: [{'x': 0, 'y': 0}],\n                popularity_list: [{'x': 0, 'y': 0}], \n                average_artist_rank: 0, \n                genre_quantity: [{'x': 0, 'y': 0}], \n                genre_intersection: [{'x': 0, 'y': 0}],\n                radialRankings: [{'angle': 360}], \n            }\n        }\n    }\n    componentDidMount() {\n        fetch('/api/personal-token')\n            .then(res => res.json())\n            .then(res => this.setState({access_token: res.access_token, refresh_token: res.refresh_token},\n            () => this.refreshToken()))\n    }\n    refreshToken() {\n        $.ajax({\n            url: '/refresh_token',\n            data: {\n            'refresh_token': this.state.refresh_token \n            },\n            success: (data) => {\n                this.setState({\n                    access_token: data.access_token\n                }, () => {\n                    this.getTopArtists();\n                });\n            }\n        });\n    }\n    getTopArtists() {\n        $.ajax({\n            url: `https://api.spotify.com/v1/me/top/artists?time_range=${this.props.timeFrame}&limit=50&offset=0`,\n            type: \"GET\",\n            beforeSend: (xhr) => {\n                xhr.setRequestHeader(\"Authorization\", \"Bearer \" + this.state.access_token);\n            },\n            success: (data) => {\n                const spotify_data = this.props.analyseTermData(data);\n                this.setState({spotify_data});\n            },\n            error: (XMLHttpRequest, textStatus, errorThrown) => { \n                console.log(\"Status: \" + textStatus); \n                console.log(\"Error: \" + errorThrown); \n            },\n        });\n    }\n    render() {\n        return (\n            <div className='spotify-components'>\n                <h2>I Like:</h2>\n                <ChartConstructor\n                    owner='me'\n                    average_artist_rank={this.state.spotify_data.average_artist_rank}\n                    top_5_artists_images={this.state.spotify_data.top_5_artists_images}\n                    data1={this.state.spotify_data.radialRankings} \n                    data2={this.state.spotify_data.top_5_artists_graph}\n                    genres={this.state.spotify_data.genre_weights}\n                />\n            </div>\n        ); \n    }\n}\n\nexport default Personal_Spotify_Data;"]},"metadata":{},"sourceType":"module"}